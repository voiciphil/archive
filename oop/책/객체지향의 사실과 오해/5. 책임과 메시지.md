# 5. 책임과 메시지

### 자율적인 책임

* 자율적인 객체란 스스로의 의지와 판단에 따라 각자 맡은 책임을 수행하는 객체를 의미한다.
* 적절한 책임이 자율적인 객체를 낳고, 자율적인 객체들이 모여 유연하고 단순한 협력을 낳는다.

### 좋지 않은 책임

* `증인` 역할을 하는 객체에게 `증언하라` 라는 메시지를 보내면 `증인` 역할의 객체는 증언할 방법을 자율적으로 선택할 수 있다.
* 하지만 `증인` 역할을 하는 객체에게 `목격했던 장면을 떠올려라`, `떠오르는 기억을 시간 순서대로 재구성하라`, `말로 간결하게 표현하라` 와 같이 메시지를 보내게 되면 **구체적인 증언 방법을 외부에서 지정하게 됨**으로써 **객체의 자율성을 감소**시킨다.
* 반대로 `증인` 역할의 객체에게 `증언하라` 대신 `설명하라` 라는 메시지를 보내게 된다면 **메시지가 너무 추상적**이어서 객체는 어떤 것을 설명해야 하는지 몰라 혼란스럽다.
  * 추상적이고 포괄적인 책임은 재사용성을 증가시키지만 협력에 참여하는 의도를 명확하게 설명할 수 있는 수준 안에서 추상적이어야 한다.
* 자율적인 책임의 특징은 객체가 어떻게 해야 하는가가 아니라 **무엇을 해야 하는가**를 설명한다는 것이다.

### 메시지와 메서드

* 메시지는 객체들이 협력하기 위해 사용할 수 있는 **유일한 의사소통 수단**이다.
* 메시지는 메시지를 받을 수신자, 메시지 이름, 송신자가 보내는 추가 정보인 인자로 구성된다.
* 객체가 수신할 수 있는 메시지가 **객체의 책임을 결정**한다.
* 객체는 메시지를 처리하기 위한 방법을 **자율적으로 선택**할 수 있다.
* 객체가 **메시지를 내부적으로 처리하는 방법**을 메서드라고 한다.

### 다형성

* 다형성이란 서로 다른 유형의 객체가 **동일한 메시지에 대해 서로 다르게 반응하는 것**을 의미한다.
* 다형성은 동일한 역할을 수행할 수 있는 객체들 간의 대체 가능성을 의미하는데 이들이 대체 가능한 이유는 동일한 메시지를 처리할 수 있기 때문이다.
* 다형성을 사용하면 송신자가 **수신자의 종류를 모르더라도 메시지를 전송**할 수 있다.
  * 즉, 다형성은 수신자의 종류를 캡슐화한다.
  * 송신자가 수신자의 종류에 의존하지 않고 메시지에 의존하기 때문에 결합도를 낮춘다.
* 다형성을 활용하면 **유연하고 확장 가능하고 재사용성이 높은 협력을 설계**할 수 있다.
  * 송신자는 수신자가 메시지를 이해한다면 수신자가 누구여도 상관하지 않기 때문에 **유연하게 협력을 변경**할 수 있다.
  * 간단하게 새로운 유형의 객체를 협력에 끼워 맞춤으로써 **협력이 수행되는 방식을 확장**할 수 있다.
  * 협력에 영향을 미치지 않고서도 다양한 객체들이 수신자의 자리를 대체할 수 있기 때문에 **협력이 수행되는 방식을 재사용**할 수 있다.

### 메시지를 따라라

* 객체지향 설계의 중심에는 메시지가 위치한다. 메시지가 객체를 선택하게 하고 **메시지 중심으로 협력을 설계**해야 한다.
  * **어떤 행위(메시지)가 필요한지 먼저 결정**한 후에 이 행위를 수행할(메시지를 수신할) 객체를 결정하라. (What / Who 사이클)
  * 수신 가능한 메시지가 모여 객체의 인터페이스를 결정한다.

### 객체 인터페이스

* 일반적으로 인터페이스란 어떤 두 사물이 마주치는 경계에서 서로 **상호작용할 수 있게 이어주는 방법이나 장치**를 의미한다.
* 인터페이스는 다음과 같은 특징을 갖는다.
  * 인터페이스의 사용법을 익히기만 하면 **내부 구조나 동작 방식을 몰라도 쉽게 대상을 조작하거나 의사를 전달**할 수 있다.
  * **인터페이스 자체는 변경하지 않고 단순히 내부 구성이나 작동 방식만을 변경**하는 것은 인터페이스 사용자에게 **어떤 영향도 미치지 않는다**.
  * 대상이 변경되더라도 **동일한 인터페이스를 제공하기만 하면 아무런 문제 없이 상호작용**할 수 있다.
* 공용 인터페이스란 **외부에 노출된 인터페이스**를 말한다.
  * 반대되는 개념으로 사적인 인터페이스가 있는데, 이는 객체 내부에서만 접근할 수 있는 인터페이스를 의미한다.

### 인터페이스와 구현의 분리

* 구현이란 객체지향에서 내부 구조와 작동 방식을 가리키는 말이다. 객체를 구성하지만 공용 인터페이스에 포함되지 않는 모든 것이 구현에 포함된다.
* **인터페이스와 구현의 분리 원칙**: 객체를 설계할 때 객체 외부에 노출되는 인터페이스와 객체의 내부에 숨겨지는 구현을 분리해서 고려하라.
  * 훌륭한 객체란 구현을 모른 채 인터페이스만 알면 쉽게 상호작용할 수 있는 객체를 의미한다.
* **소프트웨어는 항상 변경**되기 때문에 인터페이스와 구현의 분리 원칙을 지키는 것은 중요하다.
  * 인터페이스와 구현의 분리 원칙을 지키면 변경해도 외부에 영향을 미치지 않는 **안전 지대와** 변경 시 외부에 영향을 미치는 **위험 지대로 분리**할 수 있다.
  * 안전 지대가 객체의 내부 구현이고 위험 지대가 객체의 외부인 공용 인터페이스이다.

### 캡슐화

* 객체의 자율성을 보존하기 위해 **구현을 외부로부터 감추는 것**을 캡슐화라고 한다. **정보 은닉**이라고 부르기도 한다.

### 상태와 행위의 캡슐화

* 객체는 **상태와 행동을 하나의 단위**로 묶는 자율적인 실체다. 이 관점에서의 캡슐화를 **데이터 캡슐화**라고 한다.
* 객체는 상태와 행동을 묶은 후 외부에서 **반드시 외부에서 접근해야만 하는 행위를 공용 인터페이스를 통해 노출**한다.
  * 따라서 데이터 캡슐화는 **인터페이스와 구현을 분리하기 위한 전제 조건**이다.
  * 자기 자신의 상태를 스스로 관리하는 **자율적인 객체가 되기 위한 전제 조건**이기도 하다.

### 사적인 비밀의 캡슐화

* 캡슐화를 통해 변경이 빈번하게 일어나는 **불안정한 비밀을 안정적인 인터페이스 뒤로 숨길 수 있다**.
  * 일반적으로 불안정한 비밀은 **구현과 관련된 세부 사항**을 의미한다.
  * 개인적인 비밀을 공용 인터페이스 뒤에 감춤으로써 **자율성을 보장**받을 수 있다.

### 책임의 자율성이 협력의 품질을 결정한다

* **자율적인 책임은 협력을 단순하게 만든다**.
* **자율적인 책임은 객체의 외부와 내부를 명확하게 분리한다**.
* **책임이 자율적인 경우 책임을 수행하는 내부적인 방법을 변경하더라도 외부에 영향을 미치지 않는다**.
* **자율적인 책임은 협력의 대상을 다양하게 선택할 수 있는 유연성을 제공한다**.
* **객체가 수행하는 책임들이 자율적일수록 객체의 역할을 이해하기 쉬워진다**.

